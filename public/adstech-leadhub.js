window.onload=adstechLeadhubOnload;var atLh_acId="",atLh_topic="",atLh_fb="",atLh_zl="",atLh_url=window.location.href,atLh_utm_source=null,atLh_utm_medium=null,atLh_utm_campaign=null,atLh_utm_term=null,atLh_utm_content=null,atLh_gclid=null,atLh_arrTrack=[],atLh_styleBtnChat="",atLh_chatminiCRM=null,atLh_rqApi="https://services.adstech.vn/leadpool/v1/leadhub";function adstechLeadhubOnload(){var t=document.createElement("script");t.src="https://cdn.firebase.com/js/client/2.2.1/firebase.js",document.getElementsByTagName("head")[0].appendChild(t);var n=null,e="",a=document.getElementsByTagName("script");let o=localStorage.getItem("lead");null!=o&&null!=o&&""!=o&&createLead(o);for(let t=0;t<a.length;t++)if(a[t].src.indexOf("&gBtnId=")>0){var l=a[t].src.split("?")[1],i=l.split("&")[0];atLh_acId=i.split("=")[1],e=l.split("&")[1].split("=")[1]}else a[t].src.indexOf("jquery")>0&&(n=a[t].src);if(null===n||""===n){var r=document.createElement("script");r.src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js",document.getElementsByTagName("head")[0].appendChild(r)}var s="";if(atLh_url.indexOf("?")>0?(s=atLh_url.split("?")[1],atLh_arrTrack=s.split("&")):s=null,""==s||null==s)atLh_utm_source=null,atLh_utm_medium=null,atLh_utm_campaign=null,atLh_utm_term=null,atLh_utm_content=null,atLh_gclid=null;else for(let t=0;t<atLh_arrTrack.length;t++)0==atLh_arrTrack[t].indexOf("utm_source")?atLh_utm_source=atLh_arrTrack[t].split("=")[1]:0==atLh_arrTrack[t].indexOf("utm_medium")?atLh_utm_medium=atLh_arrTrack[t].split("=")[1]:0==atLh_arrTrack[t].indexOf("utm_campaign")?atLh_utm_campaign=atLh_arrTrack[t].split("=")[1]:0==atLh_arrTrack[t].indexOf("utm_term")?atLh_utm_term=atLh_arrTrack[t].split("=")[1]:0==atLh_arrTrack[t].indexOf("utm_content")?atLh_utm_content=atLh_arrTrack[t].split("=")[1]:0==atLh_arrTrack[t].indexOf("gclid")&&(atLh_gclid=atLh_arrTrack[t].split("=")[1]);fetchRetry(`${atLh_rqApi}/account/${atLh_acId}/group-buttons/${e}`,{method:"GET",headers:new Headers({Accept:"application/json","Content-Type":"application/json"})},4).then(t=>{var n=t.response.style,e=t.response.vertical,a=null,o=null,l=null,i=null;for(let n=0;n<t.response.listButton.length;n++)"CALL"==t.response.listButton[n].type?a=t.response.listButton[n]:"FORM"==t.response.listButton[n].type?o=t.response.listButton[n]:"CHAT"==t.response.listButton[n].type?atLh_styleBtnChat=t.response.listButton[n]:"FACEBOOK"==t.response.listButton[n].type?l=t.response.listButton[n]:"ZALO"==t.response.listButton[n].type&&(i=t.response.listButton[n]);adstechLeadhubWriteHtml(n,e,o,a,atLh_styleBtnChat,atLh_acId,l,i);let r=window.localStorage.getItem("leadhub_chatInfo");if(null!=r&&null!=r&&""!=r){let t=JSON.parse(r);document.getElementById("txtName").innerText=t.name,atLh_topic=t.topic}})}async function fetchRetry(t,n,e){for(let a=0;a<e;a++)try{return await fetch(t,n).then(handle).then(t=>t)}catch(t){if(a+1===e)throw t}}function handle(t){return t.text().then(n=>{const e=n&&JSON.parse(n);if(t.ok)return e;const a=e&&e.error||t.statusText;return Promise.reject(a)})}function adstechLeadhubWriteHtml(t,n,e,a,o,l,i,r){let s="",d="",c="",h="",p="",u="",m="",g="",f="",b="",y="",L="",_="",x="",v="",$="",w="",k="",C="",I=`<style>\n                    ${v="45"==t.left?`.adstech-group-btn {\n            position:fixed;\n            bottom: ${t.bottom-3}%;\n            left: ${parseInt(t.left)+2}%;\n            right: ${t.right}%;\n            top:${t.top}%;\n            z-index: 99999999;\n        }`:`.adstech-group-btn {\n            position:fixed;\n            bottom: ${t.bottom-3}%;\n            left: ${parseInt(t.left)-1}%;\n            right: ${parseInt(t.right)-1}%;\n            top:${t.top}%;\n            z-index: 99999999;\n        }`}\n\n                    .adstech-btn {\n                        border: none;\n                        color: white;\n                        text-align: center;\n                        text-decoration: none;\n                        display: inline-block;\n                        margin: 4px 2px;\n                        border-radius: 50%;\n                        width: ${t.size}px;\n                        height:${t.size}px;\n                        box-shadow: 0px 8px 15px rgba(0, 0, 0, 0.5);\n                    }\n                    \n                    #chatAdmin .input-group-sm>.form-control:not(textarea) {\n                        height: calc(1.5em + 1rem + 2px) !important;\n                    }\n                    .adstech-form {\n                        display: none;\n                        position: fixed;\n                        text-align:center;\n                        left: 50%;\n                        top: 50%;\n                        transform: translate(-50%,-50%);\n                        border: 3px solid #f1f1f1;\n                        z-index: 99999999;\n                        background-color:#fff;\n                    }\n                    #adstech-form{\n                        padding-bottom:20px\n                    }\n                    #adstech-form ::-webkit-scrollbar {\n                        width: 8px;\n                        height: 10px;\n                        z-index: 999;\n                    }\n                \n                    /* Handle */\n                    #adstech-form ::-webkit-scrollbar-thumb {\n                        -webkit-border-radius: 15px;\n                        border-radius: 15px;\n                        background: #eff2f9;\n                    }\n                    /* Add styles to the form container */\n                    .adstech-form-container {\n                        width: 400px;\n                        padding: 10px;\n                        background-color: #fff;\n                    }\n\n                    /* Full-width input fields */\n                    .adstech-form-container input[type=text],\n                    .adstech-form-container input[type=email], \n                    .adstech-form-container input[type=tel]{\n                        width: 90%;\n                        padding: 15px;\n                        margin: 5px 0 22px 0;\n                        border: none;\n                        background: #f1f1f1;\n                    }\n\n                    /* When the inputs get focus, do something */\n                    .adstech-form-container input[type=text]:focus,\n                    .adstech-form-container input[type=email]:focus,\n                    .adstech-form-container input[type=tel]:focus {\n                        background-color: #ddd;\n                        outline: none;\n                    }\n\n                    /* Set a style for the submit/login button */\n                    .adstech-form-container .btn {\n                        color: white;\n                        border: none;\n                        cursor: pointer;\n                        width: 100%;\n                        margin-bottom: 10px;\n                        opacity: 0.8;\n                        float: left;\n                        z-index: 9999999;\n                        height:40px;\n                    }\n\n                    /* Add a red background color to the cancel button */\n                    .adstech-form-container .cancel {\n                        background-color: #999;\n                    }\n\n                    /* Add some hover effects to buttons */\n                    .adstech-form-container .btn:hover,\n                    .open-button:hover {\n                        opacity: 1;\n                    }\n                    #adstech-alert {\n                        padding: 20px;\n                        background-color:#e09000;\n                        color: white;\n                        margin-bottom: 15px;\n                        display: none;\n                        width:20%;\n                        position: fixed;\n                        text-align:center;\n                        left: 50%;\n                        top: 50%;\n                        z-index: 9999999;\n                        transform: translate(-50%,-50%);\n                    }\n                    .adstech-chat-form{\n                        width:30%;\n                        margin-left:70%;\n                    }\n                    @media only screen and (max-width: 420px) {\n                        .adstech-form-container {\n                            width: 300px;\n                            padding: 10px;\n                            z-index: 99999999;\n                            background-color: #fff;\n                        }\n                        .adstech-chat-form{\n                            width:80%;\n                            margin-left:10%\n                        }\n                    }\n                    @media screen and (max-width: 1024px) and (min-width: 450px) {\n                        .adstech-chat-form{\n                            width:40%;\n                            margin-left:60%\n                        }\n                    }\n                </style>`;if(null==a||""==a?d="":"#fff"==t.color?(d=`<button class="adstech-btn" onclick="atLhOpenCall()" style="background-color:${a.buttonColor}">\n                        <a href="tel:${a.phoneNumber}" style="width:100%;height:100%">\n                            <img src="https://leadpool.adstech.vn/call-white.png" alt="Gọi điện thoại" width="${t.size/2}" height="${t.size/2}">\n                        </a>\n                    </button>`,$="<br />"):"#000"==t.color&&(d=`<button class="adstech-btn" onclick="atLhOpenCall()" style="background-color:${a.buttonColor}">\n                        <a href="tel:${a.phoneNumber}" style="width:100%;height:100%">\n                            <img src="https://leadpool.adstech.vn/call-black.png" alt="Gọi điện thoại" width="${t.size/2}" height="${t.size/2}">\n                        </a>\n                    </button>`,$="<br />"),null==o||""==o?h="":("#fff"==t.color?(h=`<button class="adstech-btn" style="background-color:${o.buttonColor}" onclick="openChat()">\n                    <img src="https://leadpool.adstech.vn/question_answer-white.png" alt="Chat" width="${t.size/2}" height="${t.size/2}">\n                </button>`,k="<br />"):"#000"==t.color&&(h=`<button class="adstech-btn" style="background-color:${o.buttonColor}" onclick="openChat()">\n                    <img src="https://leadpool.adstech.vn/question_answer-black.png" alt="Chat" width="${t.size/2}" height="${t.size/2}">\n                </button>`,k="<br />"),m=`\n            <div class="container" id="chatInputInfo" style="z-index: 99999999; display: none;  position: fixed; bottom: 5%; right: 5%; padding:10px">\n                <div style="width:100%">\n                    <div class="adstech-chat-form">\n                        <div style="width:100%">\n                            <div style="width:100%">\n                                <div class="panel" style="border: 1px solid ${o.buttonColor}">\n                                    <div class="panel-heading" style="padding:10px;border: 1px solid ${o.buttonColor}; background-color: ${o.buttonColor};">\n                                        <h6 style="color: white; margin:auto" class="panel-title">Hãy cho chúng tôi biết bạn là ai</h6>\n                                    </div> \n                                    <div class="panel-footer" style="padding:15px; background-color:#fff"> \n                                        <form id="atLhSendInfo" method="POST">\n                                            <div class="input-group input-group-sm" style="width: 100%">\n                                                <input style="width: 100%" type="text" class="form-control" required name="name" placeholder="Tên">\n                                                <input style="width: 100%" type="text" class="form-control" required name="topic" placeholder="Email/Số điện thoại">\n                                            </div>\n                                            <br>\n                                            <div class="input-group-btn">\n                                                <button style="color: white; background-color: ${o.buttonColor};" class="btn btn-block" type="submit" id="btnSend">Chat</button>\n                                            </div>\n                                        </form>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `,g=`\n            <div class="container" id="chatAdmin" style="z-index: 99999999; display: none; position: fixed; bottom: 5%; right: 5%"> \n                <div style="width:100%">\n                    <div class="adstech-chat-form">\n                        <div style="width:100%">\n                            <div style="width:100%">\n                                <div style="border: 1px solid ${o.buttonColor}">\n                                    <div style="padding:10px;border: 1px solid ${o.buttonColor}; background-color: ${o.buttonColor};">\n                                        <h6 class="panel-title" style="color: white; ">Xin chào, <span id="txtName"></span>. Hãy chat với chúng tôi</h6>\n                                    </div>\n                                    <div style="height: 350px;background-color:#fff; overflow-y: scroll;">\n                                        <div style="width:100%">\n                                            <div style="width:100% id="scollDiv"; >\n                                                <table class="table" id="messageContainer">\n                                                    <tr></tr>\n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <div style="background-color:#fff">\n                                        <form id="atLhSendessage" method="POST">\n                                            <div class="input-group input-group-sm">\n                                                <input type="text" required class="form-control" id="txtText" placeholder="nói gì đó ..">\n                                                <span class="input-group-btn">\n                                                    <button class="btn" style="color: white; background-color: ${o.buttonColor};" type="submit" id="btnSend">Gửi</button>\n                                                </span>\n                                            </div>\n                                        </form>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `),null==e||""==e)c="",f="";else{for(let t=0;t<e.properties.length;t++)"email"==e.properties[t]?y='<input type="email" placeholder="Địa chỉ email" name="email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,4}$" title="Nhập đúng email của bạn" required>':"lastName"==e.properties[t]?L='<input type="text" placeholder="Họ và tên" name="name" required>':"phone"==e.properties[t]?b='<input type="tel" placeholder="Số điện thoại" pattern="[0]{1}[0-9]{9}" title="Nhập đúng số điện thoại của bạn" name="phone" required>':"city"==e.properties[t]?_='<input type="text" placeholder="Địa chỉ" name="city" required>':"bussiness"==e.properties[t]&&(x='<input type="text" placeholder="Nghề nghiệp" name="bussiness" required>');"#fff"==t.color?(c=`<button class="adstech-btn" style="background-color:${e.buttonColor}" onclick="atLhOpenFrom()">\n                    <img src="https://leadpool.adstech.vn/mail-white.png" alt="Đăng ký ngay" width="${t.size/2}" height="${t.size/2}">\n                </button>`,w="<br />"):"#000"==t.color&&(c=`<button class="adstech-btn" style="background-color:${e.buttonColor}" onclick="atLhOpenFrom()">\n                    <img src="https://leadpool.adstech.vn/mail-black.png" alt="Đăng ký ngay" width="${t.size/2}" height="${t.size/2}">\n                </button>`,w="<br />"),f=`<div class="adstech-form" id="adstech-form">\n                    <div style="float:right;margin-top:5px; margin-right:10px; color:red"><button onclick="document.getElementById('adstech-form').style.display='none'" style="border-radius:50%; background:#fff; box-shadow:none;border: none; width:20px;height:20px;font-size:25px">&times;</button></div>\n                    <form class="adstech-form-container" id="form-adstech" method="POST">\n                        <h3>${e.title}</h3>\n                        ${L}\n                        ${b}\n                        ${y}\n                        ${_}\n                        ${x}\n                        <div style="padding:0px 14px 0px 14px">\n                            <button type="submit" class="btn" style="background-color:${e.buttonColor};">${e.description}</button>\n                        </div>\n                    </form>\n                </div>\n                \n                <div id="adstech-alert">\n                    ${e.formMessageReturn}\n                </div>`}null==i||""==i?p="":(atLh_fb=`https://m.me/${i.phoneNumber}`,p='<button class="adstech-btn" style="padding:0px" onclick="atLhOpenFacebook()"><a><img src="https://leadpool.adstech.vn/mess.png" id="adstech-open-fb" alt="Facebook" width="100%" height="100%"></a></button>'),null==r||""==r?u="":(atLh_zl=`https://zalo.me/${r.phoneNumber}`,u='<button class="adstech-btn" style="padding:0px" onclick="atLhOpenZalo()"><a><img src="https://leadpool.adstech.vn/zalo.png" id="adstech-open-zl" alt="Zalo" width="100%" height="100%"></a></button>',C="<br />"),s=0==n?`\n                <div class="adstech-group-btn">\n                    ${p}\n                    ${C}\n                    ${u}\n                    ${w}\n                    ${c}\n                    ${$}\n                    ${d}\n                    ${k}\n                    ${h}\n                </div>\n                ${m}\n                ${g}\n                ${f}\n                ${I}\n                `:`\n                <div class="adstech-group-btn">\n                    ${d}\n                    ${c}\n                    ${h}\n                    ${p}\n                    ${u}\n                </div>\n                ${m}\n                ${g}\n                ${f}\n                ${I}`;let T=document.createElement("div");T.id="adstech-group-btn",document.body.appendChild(T),document.getElementById("adstech-group-btn").innerHTML=s,null!=e&&""!=e&&atLhSend(l),null!=atLh_styleBtnChat&&""!=atLh_styleBtnChat&&(atLh_chatminiCRM=new Firebase("https://leadpoolproduct.firebaseio.com/"),atLhConnectToFirebase())}function openChat(){let t=document.getElementById("chatInputInfo"),n=document.getElementById("chatAdmin");if("block"==t.style.display||"block"==n.style.display)t.style.display="none",n.style.display="none";else{let n=window.localStorage.getItem("leadhub_chatInfo");if(null!=n&&null!=n&&""!=n){let t=JSON.parse(n);atLh_chatminiCRM.child(atLh_topic).on("child_added",function(n){var e=n.val();let a="";1!=e.isCustomer&&null!=e.isCustomer||(a=""),0==e.isCustomer&&(a=" (Admin)");let o="";o=e.name==t.name?`<tr style="padding-top: 5%;">\n                        <td style="border-radius: 10px; max-width: 80%; float: right; background-color: ${atLh_styleBtnChat.buttonColor}; color: white; margin-right: 2%; margin-top: 2%;">${e.name}${a}: ${e.message}</td>\n                    </tr>`:`<tr style="padding-top: 5%;">\n                        <td style="border-radius: 10px; max-width: 80%; float: left; background-color: #e5e5e5; margin-left: 2%; margin-top: 2%;">${e.name}${a}: ${e.message}</td>\n                    </tr>`,$("#messageContainer tr:last").after(o),$("#scollDiv").animate({scrollTop:$("#scollDiv")[0].scrollHeight},0)}),atLhStartChatting()}else t.style.display="block"}}function atLhOpenFrom(){"block"==document.getElementById("adstech-form").style.display?document.getElementById("adstech-form").style.display="none":document.getElementById("adstech-form").style.display="block"}function atLhOpenCall(){atLhSendTracing("CALL")}function atLhCloseForm(){document.getElementById("adstech-form").style.display="none"}function atLhOpenAlert(){document.getElementById("adstech-alert").style.display="block"}function atLhCloseAlert(){document.getElementById("adstech-alert").style.display="none"}function atLhOpenFacebook(){atLhSendTracing("FACEBOOK"),document.getElementById("adstech-open-fb").classList.add("at-onclick-fb"),window.open(atLh_fb)}function atLhOpenZalo(){atLhSendTracing("ZALO"),document.getElementById("adstech-open-zl").classList.add("at-onclick-zl"),window.open(atLh_zl)}function atLhGetHour(t){let n="";return n=t.split(" ")[3]}function atLhConnectToFirebase(){document.getElementById("atLhSendInfo").addEventListener("submit",t=>{const n=new FormData(t.target);let e=n.get("name");atLh_topic=n.get("topic");let a=[{property:"accountId",value:atLh_acId},{property:"lastName",value:e},{property:"email",value:atLh_topic}];fetchRetry(`${atLh_rqApi}/contacts?source_from_mar=CHAT`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)},4).then(t=>{console.log(t)}).catch(t=>{console.log(t)}),document.getElementById("txtName").innerText=e;let o={name:e,topic:atLh_topic=atLh_acId+"-"+atLh_topic.replace(/\./g,"-dot-")};window.localStorage.setItem("leadhub_chatInfo",JSON.stringify(o)),atLh_chatminiCRM.child(atLh_topic).on("child_added",function(t){let n=t.val(),e="";1!=n.isCustomer&&null!=n.isCustomer||(e=""),0==n.isCustomer&&(e=" (Admin)");let a="";a=n.name==o.name?`\n                <tr style="padding-top: 5%;">\n                    <td style="border-radius: 10px; max-width: 80%; float: right; background-color: ${atLh_styleBtnChat.buttonColor}; color: white; margin-right: 2%; margin-top: 2%;">\n                        ${n.name}${e}: ${n.message}\n                    </td>\n                </tr>`:`\n                <tr style="padding-top: 5%;">\n                    <td style="border-radius: 10px; max-width: 80%; float: left; background-color: #e5e5e5; margin-left: 2%; margin-top: 2%;">\n                        ${n.name}${e}: ${n.message}\n                    </td>\n                </tr>`,$("#messageContainer tr:last").after(a),$("#scollDiv").animate({scrollTop:$("#scollDiv")[0].scrollHeight},0)}),t.preventDefault(),atLhStartChatting()})}function atLhStartChatting(){document.getElementById("chatInputInfo").style.display="none",document.getElementById("chatAdmin").style.display="block",document.getElementById("atLhSendessage").addEventListener("submit",t=>{let n=$("#txtText").val();if(""!=n)try{atLhSendessage({topic:atLh_topic,name:document.getElementById("txtName").innerText,message:n,accountId:atLh_acId,isCustomer:!0}),document.getElementById("txtText").value=""}catch(t){alert(t)}t.preventDefault()})}function atLhSendessage(t){fetchRetry(`${atLh_rqApi}/chats`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},5).then(t=>{console.log(t)}).catch(t=>{console.log(t)})}function atLhSend(t){document.getElementById("form-adstech").addEventListener("submit",n=>{const e=new FormData(n.target);let a=e.get("email"),o=e.get("name"),l=e.get("phone"),i=e.get("city"),r=e.get("bussiness"),s=[{property:"accountId",value:t},{property:"email",value:a}];if(null!=o&&""!=o&&null!=o){let t={property:"lastName",value:o};s.push(t)}if(null!=l&&""!=l&&null!=l){let t={property:"phone",value:l};s.push(t)}if(null!=i&&""!=i&&null!=i){let t={property:"city",value:i};s.push(t)}if(null!=r&&""!=r&&null!=r){let t={property:"bussiness",value:r};s.push(t)}createLead(s),atLhSendTracing("FORM"),n.preventDefault(),atLhCloseForm()})}function createLead(t){fetchRetry(`${atLh_rqApi}/contacts`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},4).then(n=>{"200"==n.status?(localStorage.removeItem("lead".JSON.stringify(t)),atLhOpenAlert(),setTimeout(function(){atLhCloseAlert()},3e3)):(localStorage.setItem("lead".JSON.stringify(t)),atLhOpenAlert(),setTimeout(function(){atLhCloseAlert()},3e3))})}function atLhSendTracing(t){let n={type:t,accountId:atLh_acId,link:atLh_url};null!=atLh_utm_source&&(n.utm_source=atLh_utm_source),null!=atLh_utm_medium&&(n.utm_medium=atLh_utm_medium),null!=atLh_utm_campaign&&(n.utm_campaign=atLh_utm_campaign),null!=atLh_utm_term&&(n.utm_term=atLh_utm_term),null!=atLh_utm_content&&(n.utm_content=atLh_utm_content),null!=atLh_gclid&&(n.gclid=atLh_gclid),fetchRetry(`${atLh_rqApi}/tracking-source-utm`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)},4).then(t=>{console.log(t)})}